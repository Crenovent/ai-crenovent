# Task 1.3-T1: Classification Rules Definition
## RBA Build Plan Chapter 1.3 - Task 1

### TASK DESCRIPTION
Define classification rules for RBA vs RBIA vs AALA - Clear boundaries across automation types

### IMPLEMENTATION STATUS
✅ **COMPLETED** - Comprehensive classification rules system implemented with industry-specific variations

### CLASSIFICATION RULES DEFINITION

## 1. CLASSIFICATION FRAMEWORK

### 1.1 Core Classification Principles
1. **Determinism vs Intelligence**: RBA is fully deterministic, RBIA adds ML intelligence, AALA adds reasoning
2. **Complexity Handling**: Simple workflows → RBA, Moderate → RBIA, Complex → AALA
3. **Trust Requirements**: Higher trust needs favor RBA, moderate trust allows RBIA/AALA
4. **Industry Sensitivity**: Regulated industries prefer RBA, innovative industries embrace AALA
5. **Context Dependency**: Context-free → RBA, Context-aware → RBIA, Context-reasoning → AALA

### 1.2 Classification Decision Tree
```
Workflow Analysis
       │
       ▼
Has Agent Calls? ──Yes──▶ AALA
       │
       No
       ▼
Has ML Components? ──Yes──▶ RBIA
       │
       No
       ▼
Complexity > 0.8? ──Yes──▶ Consider RBIA/AALA
       │
       No
       ▼
      RBA
```

## 2. RBA CLASSIFICATION RULES

### 2.1 Primary RBA Indicators
**Rule ID**: `rba_deterministic`
**Weight**: 0.9
**Conditions**:
- `has_ml_components`: False
- `has_agent_calls`: False
- `complexity_score`: <0.5
- `decision_type`: "deterministic"

**Rule ID**: `rba_simple_validation`
**Weight**: 0.8
**Conditions**:
- `primary_purpose`: "validation"
- `step_count`: <10
- `external_apis`: <3
- `has_loops`: False

### 2.2 RBA Step Type Patterns
**Allowed Step Types**:
- `query`: Data retrieval and filtering
- `decision`: Simple if-then-else logic
- `notify`: Alerts and notifications
- `governance`: Policy and compliance checks
- `transform`: Data manipulation and formatting

**Keyword Indicators**:
- Conditional: "if", "then", "else", "when", "condition"
- Validation: "validate", "check", "verify", "ensure"
- Processing: "calculate", "format", "transform", "sync"

**Pattern Matching**:
```regex
Simple Conditions: \b(if|when)\s+\w+\s*(==|!=|>|<|>=|<=)\s*\w+
Basic Logic: \b(and|or|not)\b
Field Validation: validate|check|verify
```

### 2.3 RBA Use Case Categories
1. **Data Validation**: Field validation, format checking, completeness verification
2. **Simple Calculations**: Mathematical operations, field transformations
3. **Compliance Checks**: Policy validation, regulatory compliance
4. **Basic Routing**: Simple assignment based on fixed rules
5. **Notifications**: Alerts, emails, status updates
6. **Data Synchronization**: System-to-system data transfer

## 3. RBIA CLASSIFICATION RULES

### 3.1 Primary RBIA Indicators
**Rule ID**: `rbia_ml_augmented`
**Weight**: 0.95
**Conditions**:
- `has_ml_components`: True
- `has_agent_calls`: False
- `ml_decision_count`: >0
- `rule_decision_count`: >0

**Rule ID**: `rbia_intelligent_routing`
**Weight**: 0.85
**Conditions**:
- `has_scoring`: True
- `has_classification`: True
- `complexity_score`: 0.5-0.8
- `data_driven`: True

### 3.2 RBIA Step Type Patterns
**Required Step Types**:
- `ml_decision`: Machine learning model invocation
- `predict`: Prediction and forecasting
- `classify`: Classification and categorization
- `score`: Scoring and ranking

**Keyword Indicators**:
- ML Operations: "model", "prediction", "probability", "confidence"
- Scoring: "score", "rank", "priority", "weight"
- Classification: "classify", "category", "segment", "cluster"

**Pattern Matching**:
```regex
ML Operations: \b(predict|classify|score|model)\b
Probability: \b(probability|confidence|likelihood)\b
Thresholds: \bthreshold\s*[><=]\s*\d+\.?\d*
```

### 3.3 RBIA Use Case Categories
1. **Lead Scoring**: ML-based lead prioritization and qualification
2. **Risk Assessment**: Fraud detection, credit scoring, risk evaluation
3. **Intelligent Routing**: Smart assignment based on ML predictions
4. **Recommendation Systems**: Product, content, or action recommendations
5. **Anomaly Detection**: Outlier identification and alerting
6. **Predictive Analytics**: Forecasting and trend analysis

## 4. AALA CLASSIFICATION RULES

### 4.1 Primary AALA Indicators
**Rule ID**: `aala_agent_led`
**Weight**: 0.95
**Conditions**:
- `has_agent_calls`: True
- `reasoning_required`: True
- `multi_step_planning`: True
- `context_awareness`: True

**Rule ID**: `aala_complex_reasoning`
**Weight**: 0.9
**Conditions**:
- `complexity_score`: >0.8
- `decision_depth`: >3
- `requires_context`: True
- `adaptive_behavior`: True

### 4.2 AALA Step Type Patterns
**Required Step Types**:
- `agent_call`: AI agent invocation
- `reasoning`: Logical reasoning and inference
- `planning`: Multi-step planning and strategy
- `multi_step`: Sequential decision making

**Keyword Indicators**:
- Agent Operations: "agent", "reasoning", "planning", "goal"
- Context: "context", "memory", "history", "state"
- Reasoning: "analyze", "evaluate", "consider", "decide"

**Pattern Matching**:
```regex
Agent Operations: \b(agent|reasoning|planning|goal)\b
Context Usage: \b(context|memory|history)\b
Multi-step: \b(multi.step|sequential|chain)\b
```

### 4.3 AALA Use Case Categories
1. **Complex Customer Service**: Multi-turn conversations, problem resolution
2. **Strategic Planning**: Business strategy, resource optimization
3. **Negotiation**: Multi-party negotiations, contract discussions
4. **Investigation**: Complex analysis, root cause investigation
5. **Adaptive Workflows**: Dynamic process adjustment based on outcomes
6. **Creative Problem Solving**: Novel solution generation

## 5. INDUSTRY-SPECIFIC CLASSIFICATION RULES

### 5.1 Banking Industry Rules
**Rule ID**: `banking_conservative_rba`
**Weight**: 0.8
**Industry**: Banking
**Conditions**:
- `regulatory_sensitive`: True
- `audit_requirements`: "high"
- `deterministic_preferred`: True

**Adjustments**:
- Higher threshold for RBIA promotion (0.98 vs 0.95)
- Stricter requirements for AALA (regulatory approval needed)
- Preference for deterministic workflows
- Enhanced audit trail requirements

### 5.2 SaaS Industry Rules
**Rule ID**: `saas_aala_friendly`
**Weight**: 0.7
**Industry**: SaaS
**Conditions**:
- `innovation_tolerance`: "high"
- `user_experience_focus`: True
- `rapid_iteration`: True

**Adjustments**:
- Lower threshold for AALA promotion (0.85 vs 0.90)
- Faster promotion cycles
- User experience optimization priority
- A/B testing integration

### 5.3 Healthcare Industry Rules
**Rule ID**: `healthcare_safety_first`
**Weight**: 0.9
**Industry**: Healthcare
**Conditions**:
- `patient_safety_critical`: True
- `clinical_validation_required`: True
- `regulatory_oversight`: "FDA"

**Adjustments**:
- Highest thresholds for all promotions
- Clinical validation requirements
- Patient safety override capabilities
- HIPAA compliance mandatory

## 6. CLASSIFICATION ALGORITHM

### 6.1 Multi-Stage Classification Process
```python
def classify_workflow(workflow_definition, tenant_id):
    # Stage 1: Extract characteristics
    characteristics = extract_characteristics(workflow_definition)
    
    # Stage 2: Apply classification rules
    scores = apply_classification_rules(characteristics, tenant_id)
    
    # Stage 3: Industry-specific adjustments
    industry_code = get_tenant_industry(tenant_id)
    adjusted_scores = apply_industry_adjustments(scores, industry_code)
    
    # Stage 4: Determine final classification
    classification = determine_final_classification(adjusted_scores)
    
    # Stage 5: Calculate confidence
    confidence = calculate_confidence(adjusted_scores, characteristics)
    
    return classification, confidence, adjusted_scores
```

### 6.2 Characteristic Extraction
**Workflow Analysis**:
- Step count and types
- Decision complexity
- External integrations
- ML component detection
- Agent call identification
- Keyword and pattern analysis

**Complexity Scoring**:
```python
complexity_score = (
    step_count_factor +
    decision_complexity_factor +
    integration_complexity_factor +
    ml_complexity_factor +
    agent_complexity_factor
) / 5
```

### 6.3 Rule Evaluation
**Condition Matching**:
- Boolean conditions: Direct comparison
- Numeric conditions: Threshold comparison
- Range conditions: Within range check
- String conditions: Pattern matching

**Score Calculation**:
```python
rule_score = (matched_conditions / total_conditions) * rule_weight
automation_type_score = sum(applicable_rule_scores)
```

## 7. CONFIDENCE CALCULATION

### 7.1 Confidence Levels
- **High Confidence** (>90%): Clear indicators, significant score separation
- **Medium Confidence** (70-90%): Good indicators, moderate score separation
- **Low Confidence** (<70%): Ambiguous indicators, close scores

### 7.2 Confidence Factors
1. **Score Separation**: Difference between top two classifications
2. **Indicator Strength**: Presence of strong classification indicators
3. **Rule Coverage**: Number of applicable rules matched
4. **Industry Alignment**: Consistency with industry preferences
5. **Historical Performance**: Past classification accuracy

## 8. VALIDATION & TESTING

### 8.1 Classification Accuracy Metrics
| Metric | Target | Measurement |
|--------|--------|-------------|
| Overall Accuracy | >90% | Correct classifications / Total classifications |
| RBA Precision | >95% | True RBA / (True RBA + False RBA) |
| RBIA Precision | >85% | True RBIA / (True RBIA + False RBIA) |
| AALA Precision | >80% | True AALA / (True AALA + False AALA) |

### 8.2 Test Cases
**RBA Test Cases**:
- Simple validation workflows
- Basic calculation workflows
- Compliance checking workflows
- Data synchronization workflows

**RBIA Test Cases**:
- Lead scoring workflows
- Fraud detection workflows
- Recommendation workflows
- Predictive analytics workflows

**AALA Test Cases**:
- Customer service workflows
- Strategic planning workflows
- Complex investigation workflows
- Adaptive optimization workflows

## 9. CONTINUOUS IMPROVEMENT

### 9.1 Feedback Loop
1. **Classification Results**: Track actual vs predicted classifications
2. **Performance Monitoring**: Monitor workflow performance post-classification
3. **User Feedback**: Collect stakeholder feedback on classifications
4. **Rule Refinement**: Update rules based on feedback and performance
5. **Model Retraining**: Improve classification accuracy over time

### 9.2 Rule Evolution
- **A/B Testing**: Test new rules against existing ones
- **Performance Analysis**: Analyze rule effectiveness
- **Industry Updates**: Adapt to industry-specific changes
- **Regulatory Changes**: Update for new compliance requirements
- **Technology Evolution**: Incorporate new automation capabilities

## DEPENDENCIES
- Workflow Definition Parser (implemented)
- Tenant Industry Mapping (implemented)
- Trust Scoring Engine (implemented)
- Performance Monitoring (implemented)

## CROSS-REFERENCES
- Task 1.2-T2: Automation Continuum Map
- Task 1.2-T6: Trust Ladder Matrix
- Task 14.2: Trust Scoring & Governance Dashboards
- Vision Ch.7: Automation Type Boundaries
- Vision Ch.8: Classification Framework
